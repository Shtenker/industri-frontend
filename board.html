<table>
  <thead>
    <tr>
      <th>Order ID</th>
      <th>Row #</th>
      <th>Product Name</th>
    </tr>
  </thead>
  <tbody id="ordersTableBody"></tbody>
</table>


<script>
async function fetchAndRenderOrders() {
  try {
   
    const productsResponse = await fetch("https://industri-backend.onrender.com/products");
    const products = await productsResponse.json();
    
   
    const productMap = {};
    products.forEach(p => {
      productMap[p.articleNumber] = p.name;
    });

  
    const response = await fetch("https://industri-backend.onrender.com/orders");
    const orders = await response.json();

   
    const groupedOrders = {};
    orders.forEach(({ order_id, product_id, line_number }) => {
      if (!groupedOrders[order_id]) groupedOrders[order_id] = [];
      groupedOrders[order_id].push({ product_id, line_number });
    });

 
    const tableBody = document.getElementById("ordersTableBody");
    tableBody.innerHTML = "";

    for (const [orderId, items] of Object.entries(groupedOrders)) {
      items.sort((a, b) => a.line_number - b.line_number);
      items.forEach(({ product_id, line_number }, index) => {
        const productName = productMap[product_id] || "Unknown product";
        const row = document.createElement("tr");
        
        if (index === 0) {
       
          const orderCell = document.createElement("td");
          orderCell.textContent = orderId;
          orderCell.rowSpan = items.length;
          row.appendChild(orderCell);
        }
        
        const lineCell = document.createElement("td");
        lineCell.textContent = line_number;
        const productCell = document.createElement("td");
        productCell.textContent = productName;

        row.appendChild(lineCell);
        row.appendChild(productCell);

        tableBody.appendChild(row);
      });
    }
  } catch (err) {
    console.error("Error loading orders:", err);
  }
}
